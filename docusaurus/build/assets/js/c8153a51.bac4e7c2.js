"use strict";(self.webpackChunkbobadocs=self.webpackChunkbobadocs||[]).push([[2921],{5318:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=l(n),g=a,h=d["".concat(c,".").concat(g)]||d[g]||p[g]||s;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var l=2;l<s;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3014:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=n(5773),a=(n(7378),n(5318));const s={sidebar_position:10},o="How to Run (and Write) Tests",i={unversionedId:"engineering/legacy-pages/howto-tests",id:"engineering/legacy-pages/howto-tests",title:"How to Run (and Write) Tests",description:"Backend",source:"@site/docs/engineering/legacy-pages/howto-tests.md",sourceDirName:"engineering/legacy-pages",slug:"/engineering/legacy-pages/howto-tests",permalink:"/docs/engineering/legacy-pages/howto-tests",draft:!1,editUrl:"https://github.com/essential-randomness/bobadocs/edit/main/docs/engineering/legacy-pages/howto-tests.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"engineering",previous:{title:"Useful Commands",permalink:"/docs/engineering/legacy-pages/useful-commands"},next:{title:"External Packages/Components",permalink:"/docs/engineering/legacy-pages/external-packages"}},c={},l=[{value:"Backend",id:"backend",level:2},{value:"How to Run Backend Tests",id:"how-to-run-backend-tests",level:3},{value:"How to Write Backend Tests",id:"how-to-write-backend-tests",level:3}],u={toc:l};function p(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"how-to-run-and-write-tests"},"How to Run (and Write) Tests"),(0,a.kt)("h2",{id:"backend"},"Backend"),(0,a.kt)("p",null,"For backend testing, we use ",(0,a.kt)("inlineCode",{parentName:"p"},"mocha")," + ",(0,a.kt)("inlineCode",{parentName:"p"},"chai"),"."),(0,a.kt)("p",null,"All files ending with ",(0,a.kt)("inlineCode",{parentName:"p"},".test.ts")," are automatically run as tests. As much as possible, tests should be divided in different files according to the functionality they're testing for (e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"boards/tests/pagination.tests.ts"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"boards/tests/metadata.tests.ts"),"). "),(0,a.kt)("h3",{id:"how-to-run-backend-tests"},"How to Run Backend Tests"),(0,a.kt)("p",null,"You can run tests with the following commands:"),(0,a.kt)("p",null,"Tests use the same DB as the server! ",(0,a.kt)("strong",{parentName:"p"},"You must run ",(0,a.kt)("inlineCode",{parentName:"strong"},"yarn run start-db")," before tests.")," If you made changes to the DB (for example, by navigating through the boards in the local frontend), you will need to stop the DB and start it again."),(0,a.kt)("p",null,"Run all tests once: ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn run tests"),".\nRun all tests and watch for changes: ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn run tests:watch"),".\nRun all tests in a single file and watch for changes: ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn run tests:file server/posts/tests/queries.test.ts")," (change with appropriate file path)."),(0,a.kt)("h3",{id:"how-to-write-backend-tests"},"How to Write Backend Tests"),(0,a.kt)("p",null,"You can find a guide to testing in mocha ",(0,a.kt)("a",{parentName:"p",href:"https://codeburst.io/how-to-test-javascript-with-mocha-the-basics-80132324752e"},"here")," (but please don't install mocha globally). If you're writing a new test suite, you can use this template to get started:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'import "mocha";\nimport { expect } from "chai";\n\nimport { runWithinTransaction } from "../../test-utils";\n\ndescribe("Describe your test suite here", () => {\n  it("Describe your regular test case here", async () => {\n    // Run the code and save the result.\n    // use expect() to check that the result is what\'s expected.\n  });\n\n  it("Describe your data-muting DB query test case here", async () => {\n        await runWithinTransaction(async transaction => {\n      // Run a query that modifies the DB.\n      // Use expect() to check that the result is as expected.\n      // At the end of this method, the DB will be restored to its original state.\n        });\n  });\n}\n')))}p.isMDXComponent=!0}}]);