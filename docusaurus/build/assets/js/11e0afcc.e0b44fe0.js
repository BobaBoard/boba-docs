"use strict";(self.webpackChunkbobadocs=self.webpackChunkbobadocs||[]).push([[1789],{5318:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(7378);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||a;return n?o.createElement(h,s(s({ref:t},p),{},{components:n})):o.createElement(h,s({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5477:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var o=n(5773),r=(n(7378),n(5318));const a={sidebar_position:4},s="BobaComponents Codebase",i={unversionedId:"engineering/legacy-pages/bobaboard-ui-codebase",id:"engineering/legacy-pages/bobaboard-ui-codebase",title:"BobaComponents Codebase",description:"For installation instructions check out Setting Up Your DevEnv.",source:"@site/docs/engineering/legacy-pages/bobaboard-ui-codebase.md",sourceDirName:"engineering/legacy-pages",slug:"/engineering/legacy-pages/bobaboard-ui-codebase",permalink:"/docs/engineering/legacy-pages/bobaboard-ui-codebase",draft:!1,editUrl:"https://github.com/essential-randomness/bobadocs/edit/main/docs/engineering/legacy-pages/bobaboard-ui-codebase.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"engineering",previous:{title:"BobaEditor Codebase Guide",permalink:"/docs/engineering/legacy-pages/bobaeditor-codebase-guide"},next:{title:"How to use Storybook",permalink:"/docs/engineering/legacy-pages/howtouse-storybook"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Src Folder Structure",id:"src-folder-structure",level:2},{value:"Components Overview",id:"components-overview",level:2},{value:"Layout Structure",id:"layout-structure",level:3},{value:"Post Structure",id:"post-structure",level:3},{value:"Comments Structure",id:"comments-structure",level:3},{value:"Threads Structure",id:"threads-structure",level:3},{value:"Theming",id:"theming",level:3},{value:"How to Add a new Component",id:"how-to-add-a-new-component",level:2},{value:"Storybook",id:"storybook",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Testing",id:"testing",level:2}],p={toc:c};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,o.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"bobacomponents-codebase"},"BobaComponents Codebase"),(0,r.kt)("p",null,"For installation instructions check out ",(0,r.kt)("a",{parentName:"p",href:"/docs/engineering/start-developing/setting-up-dev-env"},"Setting Up Your DevEnv"),"."),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"The BobaComponents Codebase contains all the code pertaining to the BobaComponents component (",(0,r.kt)("a",{parentName:"p",href:"https://bobaboard-ui.netlify.app/"},"demo"),"). It's written in Typescript and React."),(0,r.kt)("p",null,"There are two important folders:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"src:")," where all the source code is."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"stories:"),' where the "testing stories" (the one you see on the demo\'s left-hand sidebar) are defined.')),(0,r.kt)("h2",{id:"src-folder-structure"},"Src Folder Structure"),(0,r.kt)("p",null,"The src folder structure is victim of some accrued tech debt and not as well-defined as it could be. Overall it ",(0,r.kt)("del",{parentName:"p"},"tries to")," follows the following rules of thumb:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"common:")," everything that's often reused throughout the UI. Buttons, Tags, Tooltips, etc. etc."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"post:")," everything that's related to posts. This includes threads and comments. It should probably be further split."),(0,r.kt)("li",{parentName:"ul"},"List")),(0,r.kt)("h2",{id:"components-overview"},"Components Overview"),(0,r.kt)("p",null,"Here is an overview of how the components in BobaComponents come together to compose the website structure."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Layout.tsx covers the page as a whole, FeedWithMenu.tsc hasthe main content feed, and SideMenu.tsx controls the side menu content.",src:n(1957).Z,width:"1002",height:"636"})),(0,r.kt)("h3",{id:"layout-structure"},"Layout Structure"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"layout/Layout.tsx"),"is the main container of the whole BobaBoard website. It includes the header, and accepts props for ",(0,r.kt)("inlineCode",{parentName:"p"},"sideMenuContent")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"mainContent"),", as indicated in the picture above. SideMenuContent is usually an instance ",(0,r.kt)("inlineCode",{parentName:"p"},"layout/SideMenu.tsx"),", while mainContent varies across pages. In board and thread view, ",(0,r.kt)("inlineCode",{parentName:"p"},"mainContent")," is an instance of ",(0,r.kt)("inlineCode",{parentName:"p"},"layout/FeedWithMenu.tsx"),"."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"FeedWithMenu")," is also comprised of two parts: the ",(0,r.kt)("inlineCode",{parentName:"p"},"sidebarContent")," and the ",(0,r.kt)("inlineCode",{parentName:"p"},"feedContent"),". It also accepts a function ",(0,r.kt)("inlineCode",{parentName:"p"},"onReachEnd")," which is called when the feed has been scrolled to the bottom. The sidebar is automatically hidden once the mobile breakpoint is reached, and will only be displayed again when the ",(0,r.kt)("inlineCode",{parentName:"p"},"showSidebar")," props is set to ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,r.kt)("h3",{id:"post-structure"},"Post Structure"),(0,r.kt)("p",null,"The component for regular, display posts is ",(0,r.kt)("inlineCode",{parentName:"p"},"post/Post.tsx"),", which has the following structure:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"There are four sections, each named after what they control: Header.tsx, Tags.tsx, Footer.tsx, and BobaEditor (which is its own repo). Card.tsx contains the code to bring it all together.",src:n(5207).Z,width:"1058",height:"801"})),(0,r.kt)("p",null,"The component for the post editor is ",(0,r.kt)("inlineCode",{parentName:"p"},"post/PostEditor.tsx")," , which follows a similar structure but swaps out ",(0,r.kt)("inlineCode",{parentName:"p"},"Footer.tsx")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"EditableFooter.tsx"),"."),(0,r.kt)("h3",{id:"comments-structure"},"Comments Structure"),(0,r.kt)("p",null,"There's two types of comments: the regular, single comment, and comment chains, which are multiple comments chained one after the other. These classes could probably be merged into one, which would be a great refactoring exercise for the willing."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Comment.tsx controls the large post-like comments, while CommentChain.tsx covers the small comment chains below larger posts.",src:n(4163).Z,width:"942",height:"452"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Imperative Handler")),(0,r.kt)("p",null,'Comments expose an "Imperative Handler", which is used for controlling actions on comments from external components. Imperative handlers can be accessed by using refs.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const handler = React.useRef<CommentHandler>();\n\n// In component\n<CommentHandler ref={handler} .../>\n\n// In code, to highlight the comment\nhandler.current.highlight();\n")),(0,r.kt)("h3",{id:"threads-structure"},"Threads Structure"),(0,r.kt)("p",null,"The files you want are ",(0,r.kt)("inlineCode",{parentName:"p"},"post/ThreadIndent.tsx")," for posts, and ",(0,r.kt)("inlineCode",{parentName:"p"},"post/CompactThreadIndent.tsx")," for comments."),(0,r.kt)("p",null,"TODO: write this. The threads structure right now is a bit of a mess. If you want the unruly task of fixing it, I shall explain to you how to proceed. Beware."),(0,r.kt)("h3",{id:"theming"},"Theming"),(0,r.kt)("p",null,"Theming is... ",(0,r.kt)("em",{parentName:"p"},"not great"),", right now. You might find some constant used throughout in ",(0,r.kt)("inlineCode",{parentName:"p"},"theme/default.tsx"),", but this should likely be refactored to use CSS vars."),(0,r.kt)("h2",{id:"how-to-add-a-new-component"},"How to Add a new Component"),(0,r.kt)("p",null,"To add a new component, you can use the following structure as a base:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},'import React from "react";\nimport classnames from "classnames";\n\nimport debug from "debug";\n// This should follow the path of the folder you\'re putting this component in\nconst log = debug("bobaui:boards:boardsSection");\n\nconst SidebarSection: React.FC<SidebarSectionProps> = (props) => {\n  log("this is a component sample!");\n  return (\n    <div\n      className={classnames("sidebar-section", { editable: props.editable })}\n    >\n      Component Sample with {props.sampleProp}!<style jsx>{`\n        .sidebar-section {\n          font-size: large;\n          color: red;\n        }\n        .sidebar-section.editable {\n          color: blue;\n        }\n      `}</style>\n    </div>\n  );\n};\n\n// Types for props\nexport interface SidebarSectionProps {\n  sampleProp: string;\n  editable: boolean;\n}\n\nexport default SidebarSection;\n')),(0,r.kt)("h2",{id:"storybook"},"Storybook"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"./howtouse-storybook"},"How to use Storybook")),(0,r.kt)("p",null,"We're currently moving to Storybook 6.0's ",(0,r.kt)("a",{parentName:"p",href:"https://storybook.js.org/docs/react/writing-stories/introduction#using-args"},"arg-based stories"),", ",(0,r.kt)("a",{parentName:"p",href:"https://storybook.js.org/docs/react/essentials/actions"},"actions")," & ",(0,r.kt)("a",{parentName:"p",href:"https://storybook.js.org/docs/react/essentials/controls"},"controls"),'. Any refactoring adding them in older places is appreciated. If you really want to overachieve, some Stories might also benefit from "',(0,r.kt)("a",{parentName:"p",href:"https://storybook.js.org/docs/react/workflows/build-pages-with-storybook"},"building pages"),'" or "',(0,r.kt)("a",{parentName:"p",href:"https://storybook.js.org/docs/react/workflows/stories-for-multiple-components"},'multiple components"'),"."),(0,r.kt)("h2",{id:"debugging"},"Debugging"),(0,r.kt)("p",null,"BobaComponents uses the ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/debug"},"debug")," JS library. To trigger debugging in the JavaScript console, you must set the value of the corresponding flag in localStorage by using one of the following commands within the console itself:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'// Print all the debug logs related to the ui\nlocalStorage.debug = "bobaui:*";\n\n// Print all the debug logs minus those ending with -verbose\nlocalStorage.debug = "bobaui:*,-bobaui:*-verbose";\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," this codebase could use a lot more logging information! Feel free to add helpful notes."),(0,r.kt)("h2",{id:"testing"},"Testing"),(0,r.kt)("p",null,"This is currently done manually. If you'd like to set up a better solution you can refer to ",(0,r.kt)("a",{parentName:"p",href:"https://www.notion.so/Implement-Storybook-Testing-d4d15ca68a3c4183b5cc67fcf8dd7d06"},"Implement Storybook Testing (Notion)"),"."))}d.isMDXComponent=!0},4163:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/comment-cfd1b7969706384cb4aadcec4e76147e.png"},5207:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/poststructure-ceb51d4d4b6fc4558a118e52fc68c4bf.png"},1957:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/ui-d814c0a25870a2b2b1889c2e105e62fd.png"}}]);